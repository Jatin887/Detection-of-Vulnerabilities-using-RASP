// Copyright (c) 2020, Varlogix Technologies
// All rights reserved.
// Our terms: https://needle.sh/terms


// Start the SDK
function start(debug = false, show_blocked_message = false, express_app=null) {
    console.log('Needle.sh: Starting SDK (version ' + g_sdk_version + ')');

    init_needle(debug, show_blocked_message, g_sdk_version, express_app);
}

function set_express_app(express_app=null) {
    var needle_app = require('./core/needle_app.js').get_needle_app();
    if (express_app !== null) {
        if (needle_app.debug_mode) console.log('Needle.sh: Adding express app middleware');
        var lang_module = 'express.router.middleware';
        express_app.use(get_wrapper(lang_module));

        needle_app.express_app = express_app;
    }
}

const init_needle = require('./core/needle_app').init_needle;
const get_wrapper = require('./core/wrappers').get_wrapper;

var g_sdk_version = '1.1.0';

// Exports
module.exports = {
    start: start,
    set_express_app: set_express_app
};